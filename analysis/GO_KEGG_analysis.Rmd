---
title: "GO and KEGG pathway analysis"
author: "ERM"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

```{css, echo=FALSE}
pre {
  max-height: 400px;
  overflow-y: auto;
}

pre[class] {
  max-height: 200px;
}
```

```{r  package loading}
library(tidyverse)
library(kableExtra)
library(broom)
library(RColorBrewer)
library(gprofiler2)
library(ChIPseeker)
library("TxDb.Hsapiens.UCSC.hg38.knownGene")
library("org.Hs.eg.db")
library(rtracklayer)
library(edgeR)
library(ggfortify)
library(limma)
library(readr)
library(BiocGenerics)
library(gridExtra)
library(VennDiagram)
library(scales)
library(ggVennDiagram)
library(BiocParallel)
library(ggpubr)
library(biomaRt)

```
##### data loading
```{r loading data}
peakAnnoList_n45_motif <- readRDS("data/peakAnnoList_n45_motif.RDS")
# list2env(peakAnnoList_n45_motif, envir = .GlobalEnv)
fills <- c("#C77CFF","#F8766D","#7CAE00",  "#00BFC4" )

EAR_df <- as.data.frame(peakAnnoList_n45_motif$EAR_n45_gr)
ESR_df <- as.data.frame(peakAnnoList_n45_motif$ESR_n45_gr)
LR_df <- as.data.frame(peakAnnoList_n45_motif$LR_n45_gr)
NR_df <- as.data.frame(peakAnnoList_n45_motif$NR_n45_gr)

toplist_ATAC <- readRDS("data/toplist_n45.RDS")

# DOX24h_peaks_hypo_list  <- toplist_ATAC %>% 
#   dplyr::filter(trt=="DOX" & time=="24 hours" & logFC<0) %>% 
#   dplyr::select(trt:logFC)
# 
# DOX24h_peaks_hyper_list <- toplist_ATAC %>% 
#   dplyr::filter(trt=="DOX" & time=="24 hours" & logFC>0) %>% 
#   dplyr::select(trt:logFC)
# 
# DOX3h_peaks_hypo_list  <- toplist_ATAC %>% 
#   dplyr::filter(trt=="DOX" & time=="3 hours" & logFC<0) %>% 
#   dplyr::select(trt:logFC)
# 
# DOX3h_peaks_hyper_list <- toplist_ATAC %>% 
#   dplyr::filter(trt=="DOX" & time=="3 hours" & logFC>0) %>% 
#   dplyr::select(trt:logFC)

median_24_lfc <- readRDS("data/median_24_lfc.RDS") %>% ungroup()
median_3_lfc <- readRDS("data/median_3_lfc.RDS") %>% ungroup()

hyper_3med <- median_3_lfc %>% 
  dplyr::filter(median > 0)

hypo_3med <- median_3_lfc %>% 
  dplyr::filter(median < 0)


hyper_24med <- median_24_lfc %>% 
  dplyr::filter(median > 0)

hypo_24med <- median_24_lfc %>% 
  dplyr::filter(median < 0)

# exp_neargene_table <- read_delim("data/n45_bedfiles/exp_neargene_table.tsv", 
#     delim = "\t", escape_double = FALSE, 
#     trim_ws = TRUE)
background_genes <- read.csv("data/other_papers/backgroundRNAlist.csv", row.names = 1)


TSS_NG_data <- read_delim("data/n45_bedfiles/TSS_NG_data.tsv", 
    delim = "\t", escape_double = FALSE, 
    trim_ws = TRUE)
Collapsed_peaks <- read_delim("data/n45_bedfiles/TSS_NG_data_collapsed_peaks.tsv",
                              delim = "\t", 
                              escape_double = FALSE, 
                              trim_ws = TRUE)

EAR_NG_3hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
  dplyr::filter(peakid %in% hyper_3med$peak) %>% 
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_3hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
   dplyr::filter(peakid %in% hyper_3med$peak) %>% 
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_3hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
   dplyr::filter(peakid %in% hyper_3med$peak) %>% 
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_3hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
   dplyr::filter(peakid %in% hyper_3med$peak) %>% 
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

EAR_NG_24hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
   dplyr::filter(peakid %in% hyper_24med$peak) %>% 
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_24hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
  dplyr::filter(peakid %in% hyper_24med$peak) %>%
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_24hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
  dplyr::filter(peakid %in% hyper_24med$peak) %>%
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_24hhyper <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
  dplyr::filter(peakid %in% hyper_24med$peak) %>%
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

EAR_NG_3hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
  dplyr::filter(peakid %in% hypo_3med$peak) %>% 
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_3hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
   dplyr::filter(peakid %in% hypo_3med$peak) %>% 
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_3hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
   dplyr::filter(peakid %in% hypo_3med$peak) %>% 
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_3hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
   dplyr::filter(peakid %in%hypo_3med$peak) %>% 
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

EAR_NG_24hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
   dplyr::filter(peakid %in% hypo_24med$peak) %>% 
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_24hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
  dplyr::filter(peakid %in% hypo_24med$peak) %>%
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_24hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
  dplyr::filter(peakid %in% hypo_24med$peak) %>% 
  dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_24hhypo <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
  dplyr::filter(peakid %in% hypo_24med$peak) %>% 
 dplyr::filter(dist_to_NG<20000 & dist_to_NG>-20000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()
###########################################################
EAR_NG_3hhyper_2k <-  TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
  dplyr::filter(peakid %in% hyper_3med$peak) %>% 
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_3hhyper_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
   dplyr::filter(peakid %in% hyper_3med$peak) %>% 
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_3hhyper_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
   dplyr::filter(peakid %in% hyper_3med$peak) %>% 
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_3hhyper_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
   dplyr::filter(peakid %in% hyper_3med$peak) %>% 
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

EAR_NG_24hhyper_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
   dplyr::filter(peakid %in% hyper_24med$peak) %>% 
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_24hhyper_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
  dplyr::filter(peakid %in% hyper_24med$peak) %>%
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_24hhyper_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
  dplyr::filter(peakid %in% hyper_24med$peak) %>%
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_24hhyper_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
  dplyr::filter(peakid %in% hyper_24med$peak) %>%
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

EAR_NG_3hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
  dplyr::filter(peakid %in% hypo_3med$peak) %>% 
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_3hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
   dplyr::filter(peakid %in% hypo_3med$peak) %>% 
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_3hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
   dplyr::filter(peakid %in% hypo_3med$peak) %>% 
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_3hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
   dplyr::filter(peakid %in%hypo_3med$peak) %>% 
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

EAR_NG_24hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% EAR_df$id) %>%
   dplyr::filter(peakid %in% hypo_24med$peak) %>% 
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

ESR_NG_24hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% ESR_df$id) %>%
  dplyr::filter(peakid %in% hypo_24med$peak) %>%
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

LR_NG_24hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% LR_df$id) %>%
  dplyr::filter(peakid %in% hypo_24med$peak) %>% 
  dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()

NR_NG_24hhypo_2k <- TSS_NG_data %>% 
    dplyr::filter(peakid %in% NR_df$id) %>%
  dplyr::filter(peakid %in% hypo_24med$peak) %>% 
 dplyr::filter(dist_to_NG<2000 & dist_to_NG>-2000) %>% 
 dplyr::select(entrezgene_id) %>% 
  distinct()


```
## Introduction

This is an updated page of GO/KEGG analysis based on previous analysis (link pending). To get this analysis, I took the peaks from my data, assigned them to the nearest RNA expressed gene, then I used my Doxorubicin ATAC peak log fold change(LFC) data at 3 hours and 24 hours to create lists of  hyper-accessible peaks (LFC >0) and hypo-accessible peaks (LFC<0) for enrichment testing. Additionally, most peaks fall within multiple response clusters (MRCs) using the Cormotif package.  This created lists of EAR-hyper, EAR-hypo, ESR-hyper,ESR-hypo, LR-hyper, LR-hypo, and NR-hyper, NR-hypo peaks at 3 and 24 hours (a total of 16 groups).  Enrichment testing was done using the neargenes assigned to each of the MRC hypo and hyper clusters, using the full list of RNA expressed genes (14,084) as the background.  This page is broken up into the following sections:  
1. Hyper and Hypo MRC response for 3 and 24 hours
2. Hyper and Hypo MRC response within 20kb of neargene 3 and 24 hours
3. Bargraphs of top KEGG/~~GO terms~~ 

### EAR response genes
#### Hyper/hypo-3hr

```{r GO_EAR 3hr}

EAR3h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_3h_hyper_resgenes.RDS")
EAR3h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_3h_hypo_resgenes.RDS")

# EAR_3h_hyper_resgenes <- gost(query = EAR_NG_3hhyper$entrezgene_id,
#                     organism = "hsapiens",
#                     significant = FALSE,
#                     ordered_query = FALSE,
#                     domain_scope = "custom",
#                     measure_underrepresentation = FALSE,
#                     evcodes = FALSE,
#                     user_threshold = 0.05,
#                     correction_method = c("fdr"),
#                     custom_bg = background_genes$ENTREZID,
#                     sources=c("GO:BP","KEGG"))
# saveRDS(EAR_3h_hyper_resgenes,"data/GO_KEGG_analysis/final_analysis/EAR_3h_hyper_resgenes.RDS")

EAR3h_hyper_nomtable <-  EAR3h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
EAR3h_hypo_nomtable <-  EAR3h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

EAR3h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in EAR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR3h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in EAR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR3h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in EAR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR3h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in EAR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```

##### 2k hyper/hypo 3 hr


```{r GO_EAR 3hr_2k}

EAR3h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_3h_hyper_resgenes_2k.RDS")
EAR3h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_3h_hypo_resgenes_2k.RDS")


EAR3h_hyper_nomtable_2k <-  EAR3h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
EAR3h_hypo_nomtable_2k <-  EAR3h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

EAR3h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in EAR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR3h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in EAR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR3h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in EAR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR3h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in EAR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```



#### Hyper/hypo-24hr

```{r GO_EAR 24hr}

EAR24h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_24h_hyper_resgenes.RDS")
EAR24h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_24h_hypo_resgenes.RDS")

EAR24h_hyper_nomtable <-  EAR24h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
EAR24h_hypo_nomtable <-  EAR24h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

EAR24h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr EAR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR24h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr EAR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR24h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr EAR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR24h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr EAR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```
##### 2k hyper/hypo 24 hr


```{r GO_EAR 24hr_2k}

EAR24h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_24h_hyper_resgenes_2k.RDS")
EAR24h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/EAR_24h_hypo_resgenes_2k.RDS")


EAR24h_hyper_nomtable_2k <-  EAR24h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
EAR24h_hypo_nomtable_2k <-  EAR24h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

EAR24h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in EAR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR24h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in EAR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR24h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in EAR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

EAR24h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in EAR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```



### ESR response genes
#### Hyper/hypo-3hr

```{r GO_ESR 3hr}

ESR3h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_3h_hyper_resgenes.RDS")
ESR3h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_3h_hypo_resgenes.RDS")

ESR3h_hyper_nomtable <-  ESR3h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
ESR3h_hypo_nomtable <-  ESR3h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

ESR3h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in ESR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR3h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in ESR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR3h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in ESR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR3h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in ESR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```
##### 2k hyper/hypo 3 hr


```{r GO_ESR 3hr_2k}

ESR3h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_3h_hyper_resgenes_2k.RDS")
ESR3h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_3h_hypo_resgenes_2k.RDS")


ESR3h_hyper_nomtable_2k <-  ESR3h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
ESR3h_hypo_nomtable_2k <-  ESR3h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

ESR3h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in ESR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR3h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in ESR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR3h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in ESR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR3h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in ESR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```


#### Hyper/hypo-24hr

```{r GO_ESR 24hr}

ESR24h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_24h_hyper_resgenes.RDS")
ESR24h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_24h_hypo_resgenes.RDS")

ESR24h_hyper_nomtable <-  ESR24h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
ESR24h_hypo_nomtable <-  ESR24h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

ESR24h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr ESR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR24h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr ESR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR24h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr ESR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR24h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr ESR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```
##### 2k hyper/hypo 24 hr


```{r GO_ESR 24hr_2k}

ESR24h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_24h_hyper_resgenes_2k.RDS")
ESR24h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/ESR_24h_hypo_resgenes_2k.RDS")


ESR24h_hyper_nomtable_2k <-  ESR24h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
ESR24h_hypo_nomtable_2k <-  ESR24h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

ESR24h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in ESR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR24h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in ESR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR24h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in ESR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

ESR24h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in ESR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```


### LR response genes
#### Hyper/hypo-3hr

```{r GO_LR 3hr}

LR3h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_3h_hyper_resgenes.RDS")
LR3h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_3h_hypo_resgenes.RDS")

LR3h_hyper_nomtable <-  LR3h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
LR3h_hypo_nomtable <-  LR3h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

LR3h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in LR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR3h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in LR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR3h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in LR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR3h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in LR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```

##### 2k hyper/hypo 3 hr

```{r GO_LR 3hr_2k}

LR3h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_3h_hyper_resgenes_2k.RDS")
LR3h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_3h_hypo_resgenes_2k.RDS")


LR3h_hyper_nomtable_2k <-  LR3h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
LR3h_hypo_nomtable_2k <-  LR3h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

LR3h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in LR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR3h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in LR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR3h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in LR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR3h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in LR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```

#### Hyper/hypo-24hr

```{r GO_LR 24hr}

LR24h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_24h_hyper_resgenes.RDS")
LR24h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_24h_hypo_resgenes.RDS")

LR24h_hyper_nomtable <-  LR24h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
LR24h_hypo_nomtable <-  LR24h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

LR24h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr LR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR24h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr LR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR24h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr LR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR24h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr LR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```
##### 2k hyper/hypo 24 hr

```{r GO_LR 24hr_2k}

LR24h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_24h_hyper_resgenes_2k.RDS")
LR24h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/LR_24h_hypo_resgenes_2k.RDS")


LR24h_hyper_nomtable_2k <-  LR24h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
LR24h_hypo_nomtable_2k <-  LR24h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

LR24h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in LR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR24h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in LR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR24h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in LR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

LR24h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in LR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```

### NR response genes

#### Hyper/hypo-3hr

```{r GO_NR 3hr}

NR3h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_3h_hyper_resgenes.RDS")
NR3h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_3h_hypo_resgenes.RDS")

NR3h_hyper_nomtable <-  NR3h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
NR3h_hypo_nomtable <-  NR3h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

NR3h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in NR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR3h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in NR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR3h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in NR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR3h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in NR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```


##### 2k hyper/hypo 3 hr

```{r GO_NR 3hr_2k}

NR3h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_3h_hyper_resgenes_2k.RDS")
NR3h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_3h_hypo_resgenes_2k.RDS")


NR3h_hyper_nomtable_2k <-  NR3h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
NR3h_hypo_nomtable_2k <-  NR3h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

NR3h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in NR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR3h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in NR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR3h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in NR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR3h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in NR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```



#### Hyper/hypo-24hr

```{r GO_NR 24hr}

NR24h_hyper_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_24h_hyper_resgenes.RDS")
NR24h_hypo_nomtable <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_24h_hypo_resgenes.RDS")

NR24h_hyper_nomtable <-  NR24h_hyper_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
NR24h_hypo_nomtable <-  NR24h_hypo_nomtable$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

NR24h_hyper_nomtable %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr NR-hyper accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR24h_hyper_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr NR-hyper accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR24h_hypo_nomtable %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in 24 hr NR-hypo accesible neargenes" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR24h_hypo_nomtable %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in 24 hr NR-hypo accesible neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```
##### 2k hyper/hypo 3 hr

```{r GO_NR 24hr_2k}

NR24h_hyper_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_24h_hyper_resgenes_2k.RDS")
NR24h_hypo_nomtable_2k <- readRDS("data/GO_KEGG_analysis/final_analysis/NR_24h_hypo_resgenes_2k.RDS")


NR24h_hyper_nomtable_2k <-  NR24h_hyper_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 
NR24h_hypo_nomtable_2k <-  NR24h_hypo_nomtable_2k$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))

NR24h_hyper_nomtable_2k %>%
  filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in NR-hyper accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR24h_hyper_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in NR-hyper accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR24h_hypo_nomtable_2k %>%
   filter(source=="GO:BP", p_value < 0.05) %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = " Significant (p<0.05) GO:BP terms found in NR-hypo accesible neargenes 2kb" ) %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR24h_hypo_nomtable_2k %>%
  filter(source=="KEGG", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "Significant (p<0.05) KEGG terms found in NR-hypo accesible neargenes 2kb") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")


```



### 3 hr and 24 hour Near-genes shared between hyper/hypo
```{r EARhypo-hyper, echo=FALSE}

ggVennDiagram(list(EAR_NG_3hhyper$entrezgene_id,EAR_NG_3hhypo$entrezgene_id),
              category.names= c("hyper\nEAR\n3","hypo\nEAR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(EAR_NG_24hhyper$entrezgene_id,EAR_NG_24hhypo$entrezgene_id),
              category.names= c("hyper\nEAR\n24 hr","hypo\nEAR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "EAR 3hr and 24hr Neargene similarities")

ggVennDiagram(list(ESR_NG_3hhyper$entrezgene_id,ESR_NG_3hhypo$entrezgene_id),
              category.names= c("hyper\nESR\n3","hypo\nESR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(ESR_NG_24hhyper$entrezgene_id,ESR_NG_24hhypo$entrezgene_id),
              category.names= c("hyper\nESR\n24 hr","hypo\nESR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "ESR 3hr and 24hr Neargene similarities")

ggVennDiagram(list(LR_NG_3hhyper$entrezgene_id,LR_NG_3hhypo$entrezgene_id),
              category.names= c("hyper\nLR\n3","hypo\nLR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(LR_NG_24hhyper$entrezgene_id,LR_NG_24hhypo$entrezgene_id),
              category.names= c("hyper\nLR\n24 hr","hypo\nLR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "LR 3hr and 24hr Neargene similarities")

ggVennDiagram(list(NR_NG_3hhyper$entrezgene_id,NR_NG_3hhypo$entrezgene_id),
              category.names= c("hyper\nNR\n3","hypo\nNR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(NR_NG_24hhyper$entrezgene_id,NR_NG_24hhypo$entrezgene_id),
              category.names= c("hyper\nNR\n24 hr","hypo\nNR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "NR 3hr and 24hr Neargene similarities")

```


```{r bargraph EAR 3hr}
EAR3h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 EAR_hyper accessible GO:BP terms")


EAR3h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 EAR_hyper accessible KEGG pathways")

EAR3h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 EAR_hypo accessible GO:BP terms")

EAR3h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 EAR_hypo accessible KEGG pathways")
```

```{r bargraph EAR 24hr}
EAR24h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 EAR_hyper accessible GO:BP terms")


EAR24h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 EAR_hyper accessible KEGG pathways")

EAR24h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 EAR_hypo accessible GO:BP terms")

EAR24h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 EAR_hypo accessible KEGG pathways")
```

```{r bargraph ESR 3hr}
ESR3h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 ESR_hyper accessible GO:BP terms")


ESR3h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 ESR_hyper accessible KEGG pathways")

ESR3h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 ESR_hypo accessible GO:BP terms")

ESR3h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 ESR_hypo accessible KEGG pathways")
```

```{r bargraph ESR 24hr}
ESR24h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 ESR_hyper accessible GO:BP terms")


ESR24h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 ESR_hyper accessible KEGG pathways")

ESR24h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 ESR_hypo accessible GO:BP terms")

ESR24h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 ESR_hypo accessible KEGG pathways")
```


```{r bargraph LR 3hr}
LR3h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 LR_hyper accessible GO:BP terms")


LR3h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 LR_hyper accessible KEGG pathways")

LR3h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 LR_hypo accessible GO:BP terms")

LR3h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 LR_hypo accessible KEGG pathways")
```

```{r bargraph LR 24hr}
LR24h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 LR_hyper accessible GO:BP terms")


LR24h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 LR_hyper accessible KEGG pathways")

LR24h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 LR_hypo accessible GO:BP terms")

LR24h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 LR_hypo accessible KEGG pathways")
```



```{r bargraph NR 3hr}
NR3h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 NR_hyper accessible GO:BP terms")


NR3h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 NR_hyper accessible KEGG pathways")

NR3h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 NR_hypo accessible GO:BP terms")

NR3h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3 NR_hypo accessible KEGG pathways")
```

```{r bargraph NR 24hr}
NR24h_hyper_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 NR_hyper accessible GO:BP terms")


NR24h_hyper_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 NR_hyper accessible KEGG pathways")

NR24h_hypo_nomtable %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 NR_hypo accessible GO:BP terms")

NR24h_hypo_nomtable %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24 NR_hypo accessible KEGG pathways")
```





### 3 hr and 24 hour 2K Near-genes shared between hyper/hypo
```{r EARhypo-hyper_2k, echo=FALSE}

ggVennDiagram(list(EAR_NG_3hhyper_2k$entrezgene_id,EAR_NG_3hhypo_2k$entrezgene_id),
              category.names= c("hyper\nEAR\n3","hypo\nEAR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(EAR_NG_24hhyper_2k$entrezgene_id,EAR_NG_24hhypo_2k$entrezgene_id),
              category.names= c("hyper\nEAR\n24 hr","hypo\nEAR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "EAR 3hr and 24hr Neargene_2k similarities")

ggVennDiagram(list(ESR_NG_3hhyper_2k$entrezgene_id,ESR_NG_3hhypo_2k$entrezgene_id),
              category.names= c("hyper\nESR\n3","hypo\nESR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(ESR_NG_24hhyper_2k$entrezgene_id,ESR_NG_24hhypo_2k$entrezgene_id),
              category.names= c("hyper\nESR\n24 hr","hypo\nESR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "ESR 3hr and 24hr Neargene_2k similarities")

ggVennDiagram(list(LR_NG_3hhyper_2k$entrezgene_id,LR_NG_3hhypo_2k$entrezgene_id),
              category.names= c("hyper\nLR\n3","hypo\nLR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(LR_NG_24hhyper_2k$entrezgene_id,LR_NG_24hhypo_2k$entrezgene_id),
              category.names= c("hyper\nLR\n24 hr","hypo\nLR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "LR 3hr and 24hr Neargene_2k similarities")

ggVennDiagram(list(NR_NG_3hhyper_2k$entrezgene_id,NR_NG_3hhypo_2k$entrezgene_id),
              category.names= c("hyper\nNR\n3","hypo\nNR\n3"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  ggVennDiagram(list(NR_NG_24hhyper_2k$entrezgene_id,NR_NG_24hhypo_2k$entrezgene_id),
              category.names= c("hyper\nNR\n24 hr","hypo\nNR\n24 hr"))+
 scale_x_continuous(expand = expansion(mult = .2))+
  labs(title = "NR 3hr and 24hr Neargene_2k similarities")

```


```{r bargraph EAR_2k 3hr}
EAR3h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k EAR_hyper accessible GO:BP terms")


EAR3h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k EAR_hyper accessible KEGG pathways")

EAR3h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k EAR_hypo accessible GO:BP terms")

EAR3h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k EAR_hypo accessible KEGG pathways")
```

```{r bargraph EAR_2k 24hr}
EAR24h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k EAR_hyper accessible GO:BP terms")


EAR24h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k EAR_hyper accessible KEGG pathways")

EAR24h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k EAR_hypo accessible GO:BP terms")

EAR24h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#F8766D")+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k EAR_hypo accessible KEGG pathways")
```



```{r bargraph ESR_2k 3hr}
ESR3h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k ESR_hyper accessible GO:BP terms")


ESR3h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k ESR_hyper accessible KEGG pathways")

ESR3h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k ESR_hypo accessible GO:BP terms")

ESR3h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k ESR_hypo accessible KEGG pathways")
```

```{r bargraph ESR_2k 24hr}
ESR24h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k ESR_hyper accessible GO:BP terms")


ESR24h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k ESR_hyper accessible KEGG pathways")

ESR24h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k ESR_hypo accessible GO:BP terms")

ESR24h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[3])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k ESR_hypo accessible KEGG pathways")
```


```{r bargraph LR_2k 3hr}
LR3h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k LR_hyper accessible GO:BP terms")


LR3h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k LR_hyper accessible KEGG pathways")

LR3h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k LR_hypo accessible GO:BP terms")

LR3h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k LR_hypo accessible KEGG pathways")
```

```{r bargraph LR_2k 24hr}
LR24h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k LR_hyper accessible GO:BP terms")


LR24h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k LR_hyper accessible KEGG pathways")

LR24h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k LR_hypo accessible GO:BP terms")

LR24h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[4])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k LR_hypo accessible KEGG pathways")
```



```{r bargraph NR_2k 3hr}
NR3h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k NR_hyper accessible GO:BP terms")


NR3h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k NR_hyper accessible KEGG pathways")

NR3h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k NR_hypo accessible GO:BP terms")

NR3h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
     geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("3_2k NR_hypo accessible KEGG pathways")
```

```{r bargraph NR_2k 24hr}
NR24h_hyper_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k NR_hyper accessible GO:BP terms")


NR24h_hyper_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=20) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k NR_hyper accessible KEGG pathways")

NR24h_hypo_nomtable_2k %>%
filter(source=="GO:BP") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
       geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k NR_hypo accessible GO:BP terms")

NR24h_hypo_nomtable_2k %>%
filter(source=="KEGG") %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
      geom_col(fill=fills[1])+
  geom_vline(aes(xintercept=-log(0.05,base = 10)), col="red",linetype = 2)+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("24_2k NR_hypo accessible KEGG pathways")
```





## experimental GO
```{r noodles, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}

### Trying to make lists of DEG RNA neargene peaks and that are hyper and hypo accessible for AC only peaks

siglist_n45 <- readRDS("data/siglist_n45.RDS")
peak_24hr_list <- sapply(siglist_n45[1:4], "[","peak")
peak_24hr_list <- sapply(siglist_n45[6:9], "[","peak")

ggVennDiagram(peak_24hr_list)

test <-calculate.overlap(peak_24hr_list)
AC_only <- test$a12

TOP2_only <- test$a6

length(intersect(TOP2_only,NR_df$id))
length(intersect(TOP2_only,LR_df$id))
length(intersect(TOP2_only,ESR_df$id))
length(intersect(TOP2_only,EAR_df$id))


length(intersect(AC_only,NR_df$id))
length(intersect(AC_only,LR_df$id))
length(intersect(AC_only,ESR_df$id))
length(intersect(AC_only,EAR_df$id))



NR_hyper_list_AC <- TSS_NG_data %>%
  dplyr::filter(peakid %in% intersect(AC_only,NR_df$id)) %>%
  dplyr:: filter(peakid %in% DOX24h_peaks_hyper_list$peak) %>%
  dplyr::filter(dist_to_NG<20000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()

NR_hypo_list_AC <- TSS_NG_data %>%
  dplyr::filter(peakid %in% intersect(AC_only,NR_df$id)) %>%
  dplyr:: filter(peakid %in% DOX24h_peaks_hypo_list$peak) %>%
  dplyr::filter(dist_to_NG<20000) %>% 
  dplyr::select(entrezgene_id) %>% 
  distinct()
# NR_hyper_resgenes_AC <- gost(query =intersect(NR_hyper_list_AC$ENTREZID,Resp_RNA$ENTREZID),
#                     organism = "hsapiens",
#                     significant = FALSE,
#                     ordered_query = FALSE,
#                     domain_scope = "custom",
#                     measure_underrepresentation = FALSE,
#                     evcodes = FALSE,
#                     user_threshold = 0.05,
#                     correction_method = c("fdr"),
#                     custom_bg = background_genes$ENTREZID,
#                     sources=c("GO:BP","KEGG"))
# saveRDS(NR_hyper_resgenes_AC,"data/GO_KEGG_analysis/NR_hyper_resgenes_AC.RDS")


NR_hypo_resgenes_AC <- readRDS("data/GO_KEGG_analysis/NR_hypo_resgenes_AC.RDS")

NR_hypo_restable_AC <- NR_hypo_resgenes_AC$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 

NR_hypo_restable_AC %>%
   filter(source=="GO:BP", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = "GO:BP terms found in NR_hypo neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR_hypo_restable_AC %>%
  filter(source=="KEGG") %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "KEGG terms found in NR_hypo accesible genes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")
# intersect(unique(Resp_RNA$ENTREZID), unique(NR_peak_list_20k$ENTREZID)))

NR_hypo_restable_AC %>%
filter(source=="GO:BP", p_value < 0.05) %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#C77CFF")+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("NR_hypo accessible gene list")



NR_hyper_resgenes_AC <- readRDS("data/GO_KEGG_analysis/NR_hyper_resgenes_AC.RDS")

NR_hyper_restable_AC <- NR_hyper_resgenes_AC$result %>% 
  dplyr::select(c(source, term_id,
                  term_name,intersection_size, 
                   term_size, p_value))# %>% 

NR_hyper_restable_AC %>%
   filter(source=="GO:BP", p_value < 0.05) %>%
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(.,caption = "GO:BP terms found in NR_hypo neargenes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")

NR_hyper_restable_AC %>%
  filter(source=="KEGG") %>% 
  mutate_at(.vars = 6, .funs = scientific_format()) %>%
  kable(., caption = "KEGG terms found in NR_hypo accesible genes") %>%
  kable_paper("striped", full_width = FALSE) %>%
  kable_styling(
    full_width = FALSE,
    position = "left",
    bootstrap_options = c("striped", "hover")
  ) %>%
  scroll_box(width = "100%", height = "400px")
# intersect(unique(Resp_RNA$ENTREZID), unique(NR_peak_list_20k$ENTREZID)))

NR_hyper_restable_AC %>%
filter(source=="GO:BP", p_value < 0.05) %>% 
  slice_head(n=10) %>% 
  mutate(log10_p=(-log(p_value, base=10))) %>% 
  ggplot(., aes(x=log10_p, y=reorder(term_name, log10_p)))+
    geom_col(fill="#C77CFF")+
  theme_bw()+
  ylab("")+
  xlab(paste0("-log10 p-value"))+
  guides(fill="none")+
  theme(axis.text.y = element_text(color="black"))+
  ggtitle("NR_hypo accessible gene list")


```
